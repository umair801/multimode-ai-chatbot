<nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
        <a class="navbar-brand fw-bold" href="/">
            <i class="bi bi-robot me-2"></i>
            Research & Freelancing AI
        </a>
        
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav me-auto">
                <li class="nav-item">
                    <a class="nav-link" href="/">
                        <i class="bi bi-chat-dots me-1"></i>Chat
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/image">
                        <i class="bi bi-image me-1"></i>Image Generator
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/dashboard">
                        <i class="bi bi-graph-up me-1"></i>Data Dashboard
                    </a>
                </li>
            </ul>
            
            <ul class="navbar-nav">
                <li class="nav-item dropdown">
                    <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">
                        <i class="bi bi-gear me-1"></i>Tools
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#" onclick="exportChat()">
                            <i class="bi bi-download me-2"></i>Export Chat
                        </a></li>
                        <li><a class="dropdown-item" href="#" onclick="clearChat()">
                            <i class="bi bi-trash me-2"></i>Clear History
                        </a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item" href="#" data-bs-toggle="modal" data-bs-target="#helpModal">
                            <i class="bi bi-question-circle me-2"></i>Help
                        </a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<!-- Help Modal -->
<div class="modal fade" id="helpModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="bi bi-question-circle me-2"></i>How to Use This Chatbot
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6><i class="bi bi-graph-up text-primary me-2"></i>Data Science & Analytics</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• Machine learning models</li>
                            <li>• Statistical analysis</li>
                            <li>• Predictive modeling</li>
                            <li>• Data preprocessing</li>
                        </ul>
                        
                        <h6><i class="bi bi-code-slash text-success me-2"></i>Web Development</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• Full-stack solutions</li>
                            <li>• Responsive design</li>
                            <li>• Modern frameworks</li>
                            <li>• Database optimization</li>
                        </ul>
                        
                        <h6><i class="bi bi-gear text-warning me-2"></i>Automation & Scripting</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• Process automation</li>
                            <li>• Web scraping</li>
                            <li>• Workflow optimization</li>
                            <li>• Task scheduling</li>
                        </ul>
                        
                        <h6><i class="bi bi-bar-chart text-danger me-2"></i>Business Intelligence</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• Dashboard creation</li>
                            <li>• KPI tracking</li>
                            <li>• Executive reports</li>
                            <li>• Data insights</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6><i class="bi bi-file-text text-secondary me-2"></i>Technical Writing</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• API documentation</li>
                            <li>• User manuals</li>
                            <li>• Technical guides</li>
                            <li>• Content review</li>
                        </ul>
                        
                        <h6><i class="bi bi-pie-chart text-dark me-2"></i>Data Visualization</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• Interactive charts</li>
                            <li>• Business dashboards</li>
                            <li>• Report design</li>
                            <li>• Visual analytics</li>
                        </ul>
                        
                        <h6><i class="bi bi-cloud text-info me-2"></i>API Development</h6>
                        <ul class="list-unstyled ps-3">
                            <li>• REST API design</li>
                            <li>• Third-party integrations</li>
                            <li>• Microservices</li>
                            <li>• API documentation</li>
                        </ul>
                        
                        <h6><i class="bi bi-keyboard text-warning me-2"></i>Keyboard Shortcuts</h6>
                        <ul class="list-unstyled ps-3 small">
                            <li><kbd>Enter</kbd> - Send message</li>
                            <li><kbd>Shift+Enter</kbd> - New line</li>
                            <li><kbd>Ctrl+K</kbd> - Clear chat</li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Got it!</button>
            </div>
        </div>
    </div>
</div>

<script>
function exportChat() {
    const sessionId = localStorage.getItem('chatSessionId') || 'default';
    fetch(`/api/chat/export/${sessionId}`)
        .then(response => response.json())
        .then(data => {
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `chat_export_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            showToast('Chat exported successfully!', 'success');
        })
        .catch(error => {
            showToast('Failed to export chat', 'danger');
        });
}

function clearChat() {
    if (confirm('Are you sure you want to clear the chat history?')) {
        const sessionId = localStorage.getItem('chatSessionId') || 'default';
        if (window.chatWebSocket) {
            window.chatWebSocket.close();
        }
        localStorage.removeItem('chatSessionId');
        location.reload();
    }
}
</script>